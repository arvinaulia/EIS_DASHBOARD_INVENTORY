"
--  Data Geser tapi bisa Push 
SELECT 
	VENDINVOICEJOUR.INVOICEDATE AS [date],
	INVENTTABLE.ITEMID AS [product_id],
	INVENTTABLE.ITEMNAME AS [product_name],
	VENDINVOICETRANS.PURCHUNIT AS [uom],
    ROUND(REPLACE(CAST(VENDINVOICETRANS.QTY AS BIGINT),'.', ','),1) AS qty,
	ROUND(REPLACE(cast((VENDINVOICETRANS.LINEAMOUNT/VENDINVOICETRANS.QTY) AS BIGINT),'.',','),1) AS [price],
	ROUND(REPLACE(cast(VENDINVOICETRANS.LINEAMOUNT AS BIGINT),'.',','),1) AS [total_price],
	--'' AS [updateindb],
	22 AS [company_id],
	VENDTABLE.ACCOUNTNUM AS [supplier_id], 
	VENDTABLE.NAME AS [supplier_name], 
	CASE WHEN LEN(INVENTTABLE.ITEMGROUPID) = 8 THEN INVENTTABLE.ITEMGROUPID+'-00'
		ELSE INVENTTABLE.ITEMGROUPID END AS [product_category],
	INVENTTABLE.DIMGROUPID AS [group_category]
--	INVENTTABLE.ITEMGROUPID AS [group_category]	
FROM  VENDINVOICEJOUR 
INNER JOIN VENDINVOICETRANS ON VENDINVOICEJOUR.DATAAREAID = VENDINVOICETRANS.DATAAREAID -- AND VENDINVOICEJOUR.DATAAREAID IN ('NEDA','NIEA','NECA') 
		   AND VENDINVOICEJOUR.INVOICEID <> '' AND VENDINVOICEJOUR.PURCHID = VENDINVOICETRANS.PURCHID 
		   AND VENDINVOICEJOUR.INVOICEID = VENDINVOICETRANS.INVOICEID 
INNER JOIN VENDTABLE ON VENDINVOICEJOUR.DATAAREAID = VENDTABLE.DATAAREAID AND VENDINVOICEJOUR.INVOICEACCOUNT = VENDTABLE.ACCOUNTNUM 
INNER JOIN INVENTDIM ON INVENTDIM.INVENTDIMID = VENDINVOICETRANS.INVENTDIMID AND INVENTDIM.DATAAREAID ='VIRT' 
INNER JOIN INVENTTABLE ON INVENTTABLE.ITEMID = VENDINVOICETRANS.ITEMID AND INVENTTABLE.DATAAREAID ='VIRT' 
INNER JOIN DATAAREA ON DATAAREA.ID = VENDINVOICEJOUR.DATAAREAID 
INNER JOIN PURCHTABLE ON PURCHTABLE.PURCHID = VENDINVOICEJOUR.PURCHID
--WHERE CONVERT(VARCHAR,VENDINVOICEJOUR.INVOICEDATE,112) = '"+((String)globalMap.get("ymd"))+"' 
WHERE LEFT(CONVERT(varchar,VENDINVOICEJOUR.INVOICEDATE,112),6) = '"+((String)globalMap.get("ym"))+"' 
--WHERE CONVERT(VARCHAR,VENDINVOICEJOUR.INVOICEDATE,112) between '20220101' and '20220114' -- = '"+((String)globalMap.get("ymd"))+"' 
AND VENDTABLE.ISINTERCOMPANY IN ('0')



"
